<script>
  var associated_user_true = function () {
    $('#profile_user_attributes_password').removeAttr("disabled");
    $('#profile_user_attributes_password_confirmation').removeAttr("disabled");
    $('#profile_user_attributes_password').removeAttr("disabled");
    $('#profile_user_attributes_password_confirmation').removeAttr("disabled");
    $('#associated-user-password-fields').show();
  }

  var associated_user_false = function () {
    $('#profile_user_attributes_password').val("");
    $('#profile_user_attributes_password').attr("disabled", "disabled");
    $('#profile_user_attributes_password_confirmation').val("");
    $('#profile_user_attributes_password_confirmation').attr("disabled", "disabled");
    $('#associated-user-password-fields').hide();
  }

  var adjust_form_for_associated_user = function () {
    var associated_user_checked = ($('#profile_associated_user').prop('checked'));

    if (associated_user_checked) {
      associated_user_true()
    } else if (associated_user_checked == false) {
      associated_user_false()
    }
  }

  $('#profile_associated_user').change(adjust_form_for_associated_user)
  adjust_form_for_associated_user()
</script>
